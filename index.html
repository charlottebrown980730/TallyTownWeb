<html>
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-LM8QSXXZT7"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-LM8QSXXZT7');
    </script>

    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>TallyTown</title>
    <link rel="shortcut icon" href="TemplateData/favicon.ico">	
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <script src="webglScreen.js"></script>
</head>

<body style="margin: 0; overflow:hidden">

    <!-- ✅ 添加全屏按钮 -->
    <button id="fullscreen-btn" onclick="goFullScreen()" style="
        position: fixed;
        bottom: 16px;
        right: 16px;
        z-index: 9999;
        padding: 10px 15px;
        background-color: #2196F3;
        color: white;
        border: none;
        border-radius: 5px;
        font-size: 16px;
        box-shadow: 0 2px 6px rgba(0,0,0,0.3);
    ">
        点击全屏
    </button>

    <iframe id="Frame" src="game.html" style="border-width:0px;position:absolute;width:100%;height:100%;"></iframe>

    <script>
        // ✅ 全屏函数
        function goFullScreen() {
            const iframe = document.documentElement; // 全屏整个页面
            if (iframe.requestFullscreen) {
                iframe.requestFullscreen();
            } else if (iframe.webkitRequestFullscreen) { /* Safari */
                iframe.webkitRequestFullscreen();
            } else if (iframe.msRequestFullscreen) { /* IE11 */
                iframe.msRequestFullscreen();
            }

            // 点击后隐藏按钮
            document.getElementById("fullscreen-btn").style.display = "none";
            // 也可以加 window.scrollTo(0,0) 来尝试隐藏地址栏
        }
    </script>

    <script>
        //开始时调用
        window.gameframe = document.getElementById("Frame");
        window.WebglOrientation = WebglScreenOrientation.AutoRotation
        RotScreen()
        window.addEventListener("resize", function () {
            RotScreen();
        });
        window.addEventListener("orientationchange", function () {
            RotScreen();
        });
    </script>

    <script>
        const url = "StreamingAssets/webglscreenSetting/ScreenConfig.json";
        var xhr = new XMLHttpRequest();
        xhr.onreadystatechange = function () {
            if (xhr.readyState === 4 && xhr.status === 200) {
                var json = xhr.responseText;
                var data = JSON.parse(json);
                window.WebglOrientation = data.ScreenOrientation;
                RotScreen();
            }
        };
        xhr.open("GET", url, true);
        xhr.send();
    </script>

</body>
</html>
