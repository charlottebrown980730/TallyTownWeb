<html>
	<head>
		<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-LM8QSXXZT7"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-LM8QSXXZT7');
</script>
		<meta charset="utf-8">
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<title>TallyTown</title>
		<link rel="shortcut icon" href="TemplateData/favicon.ico">	
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="mobile-web-app-capable" content="yes">
		<script src="webglScreen.js"></script>
	</head>
	<body style="margin: 0; padding: 0; overflow:hidden; width: 100%; height: 100%; position: fixed;">
		<div id="game-container" style="position: relative; width: 100%; height: calc(100%);">
			<iframe id="Frame" src="game.html" style="border-width:0; position:absolute; top: 0; left: 0; right: 0; bottom: 0; width: 100%; height: 100%;"></iframe>
		</div>
		<script>
			//开始时调用
			window.gameframe = document.getElementById("Frame");
			window.WebglOrientation=WebglScreenOrientation.AutoRotation
			
			// Fix for iOS Chrome viewport issues
			function fixIOSChromeHeight() {
				const isIOS = /iPhone|iPad|iPod/i.test(navigator.userAgent);
				const isChrome = /CriOS/i.test(navigator.userAgent);
				
				if (isIOS && isChrome) {
					document.documentElement.style.height = window.innerHeight + 'px';
					document.body.style.height = window.innerHeight + 'px';
					document.getElementById("game-container").style.height = window.innerHeight + 'px';
				}
			}
			
			// Call the fix initially
			fixIOSChromeHeight();
			
			RotScreen()
			window.addEventListener("resize", function () {
				fixIOSChromeHeight();
				RotScreen();
			})
			window.addEventListener("orientationchange", function () {
				fixIOSChromeHeight();
				RotScreen();
			})
			
			// Force a height recalculation on iOS Chrome
			if(/iPhone|iPad|iPod/i.test(navigator.userAgent) && /CriOS/i.test(navigator.userAgent)) {
				// Add additional listeners for iOS Chrome
				window.addEventListener("scroll", fixIOSChromeHeight);
				window.addEventListener("touchmove", fixIOSChromeHeight);
				window.addEventListener("touchend", fixIOSChromeHeight);
				
				// Force a height recalculation after a short delay
				setTimeout(fixIOSChromeHeight, 100);
				setTimeout(fixIOSChromeHeight, 500);
			}
		</script>
		<script>
			const Http = new XMLHttpRequest();
			const url="StreamingAssets/webglscreenSetting/ScreenConfig.json";
			// 创建一个新的 XMLHttpRequest 对象  
			var xhr = new XMLHttpRequest();  
			
			// 设置请求类型为 GET，并指定请求的 URL  
			
			// 设置请求完成后的回调函数  
			xhr.onreadystatechange = function () {  
				// 检查请求是否成功完成（状态码为 200）  
				if (xhr.readyState === 4 && xhr.status === 200) {  
					// 读取响应文本  
					var json = xhr.responseText;  
					// 解析 JSON 字符串为 JavaScript 对象  
					var data = JSON.parse(json);  
					// 将解析后的数据中的 ScreenOrientation 赋值给 window.WebglOrientation  
					window.WebglOrientation = data.ScreenOrientation;  
					// 调用 RotScreen 函数（假设该函数已定义）  
					RotScreen();  
				}  
			};  
			xhr.open("GET", url, true);  
			xhr.send()
		</script>
		<style>
			:root {
				--sat: env(safe-area-inset-top);
				--sar: env(safe-area-inset-right);
				--sab: env(safe-area-inset-bottom);
				--sal: env(safe-area-inset-left);
			}
			html, body {
				height: 100%;
				width: 100%;
				padding: 0;
				margin: 0;
				overflow: hidden;
				position: fixed;
				touch-action: none;
			}
			#Frame {
				padding: var(--sat) var(--sar) var(--sab) var(--sal);
				box-sizing: border-box;
			}
			/* iOS Chrome specific fixes */
			@supports (-webkit-touch-callout: none) {
				#game-container {
					height: -webkit-fill-available !important;
				}
			}
		</style>
	</body>
	
</html>
